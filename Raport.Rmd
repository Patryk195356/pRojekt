---
title: "Czynniki wpływające na przebieg choroby nowotworowej"
author: "Patryk Woźniak, Iga Tumanik, Aleksandra Pellowska"
date: "`r Sys.Date()`"
output:
  rmdformats::material:
    highlight: kate
    #toc: true
    #toc_depth: 3
    self_contained: true
    number_sections: true
    code_folding: show
    fig_width: 8
    fig_height: 5
    fig_caption: true
---

```{r setup, include=FALSE}
## Global options
knitr::opts_chunk$set(cache = TRUE)
dane <- read.csv("cancer patient data sets.csv")
dane
library(tidyverse)

library(naniar)

library(validate)

library(validatetools)

library(dcmodify)

library(errorlocate)
dane$Gender <- factor(dane$Gender,
                      levels = c(1, 2),
                      labels = c("mężczyzna", "kobieta"))
```


# Wprowadzenie 

Celem naszego projektu jest analiza zbioru danych dotyczących pacjentów z rakiem płuc. Zbiór danych zawiera informacje demograficzne, kliniczne oraz wyniki leczenia pacjentów. W ramach analizy przeprowadzimy eksploracyjną analizę danych (EDA), a także zastosujemy różne metody statystyczne i uczenia maszynowego w celu zidentyfikowania czynników wpływających na przebieg choroby oraz prognozowania wyników leczenia. Zbiór danych zawiera `r nrow(dane)` wierszy oraz `r ncol(dane)` kolumn.

## Opis danych 

Zbiór danych zawiera następujące kolumny: 

-Age: Wiek pacjenta

-Gender: Płeć pacjenta

-Air Pollution: Poziom narażenia pacjenta na zanieczyszczenie powietrza

-Alcohol use: Poziom spożycia alkoholu przez pacjenta

-Dust Allergy: Poziom alergii na kurz u pacjenta

-Occupational Hazards: Poziom zagrożeń zawodowych, na jakie narażony jest pacjent

-Genetic Risk: Poziom ryzyka genetycznego pacjenta

-Chronic Lung Disease: Poziom nasilenia przewlekłej choroby płuc u pacjenta

-Balanced Diet: Stopień stosowania przez pacjenta zbilansowanej diety

-Obesity: Poziom otyłości pacjenta

-Smoking: Poziom palenia tytoniu przez pacjenta

-Passive Smoker: Poziom narażenia pacjenta na bierne palenie

-Chest Pain: Poziom bólu w klatce piersiowej u pacjenta

-Coughing of Blood: Poziom krwioplucia u pacjenta

-Fatigue: Poziom zmęczenia pacjenta

-Weight Loss: Poziom utraty masy ciała u pacjenta

-Shortness of Breath: Poziom duszności u pacjenta

-Wheezing: Poziom świszczącego oddechu u pacjenta

-Swallowing Difficulty: Stopień trudności w połykaniu u pacjenta

-Clubbing of Finger Nails: Stopień pałeczkowatości palców u pacjenta

# Data Wrangling

## Braki danych

```{r}
procent <- prop_complete_var(dane)*100

```


W danych znajduje się `r procent` % kompletnych wartości 
```{r}
naniar::vis_miss(dane)
gg_miss_fct(x=dane, fct=Gender)
```

## Wzorzec braków danych

```{r}
library(finalfit)
missing_pattern(dane)
```
## Walidacja danych

Czy wiek <= 120?

```{r}
reguly <- validator(
  Age >0 , Age <120)
```

```{r}
cf<- confront(dane, reguly, key="index")
summary(cf)
barplot(cf)
```

# Wizualizacja danych
## Histogram wieku
```{r}
ggplot(dane, aes(x = Age)) +
  geom_histogram(bins = 20) +
  theme_minimal()
```
## Wykres słupkowy poziomu choroby 
```{r}
ggplot(dane, aes(x = Level)) +
  geom_bar() +
  theme_minimal()
```
## Wykres słupkowy skumulowany: Smoking vs. Level
```{r}
ggplot(dane, aes(x = Smoking, fill = Level)) +
  geom_bar(position = "fill") +
  ylab("Udział w grupie") +
  theme_minimal()
