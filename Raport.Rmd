---
title: "Czynniki wpływające na przebieg choroby nowotworowej"
author: "Patryk Woźniak, Iga Tumanik, Aleksandra Pellowska"
date: "`r Sys.Date()`"
output:
  rmdformats::material:
    highlight: kate
    #toc: true
    #toc_depth: 3
    self_contained: true
    number_sections: true
    code_folding: show
    fig_width: 8
    fig_height: 5
    fig_caption: true
---

```{r setup, include=FALSE}
## Global options
knitr::opts_chunk$set(cache = TRUE)
dane <- read.csv("cancer patient data sets.csv")
dane
library(tidyverse)

library(naniar)

library(validate)

library(validatetools)

library(dcmodify)

library(errorlocate)
dane$Gender <- factor(dane$Gender,
                      levels = c(1, 2),
                      labels = c("mężczyzna", "kobieta"))
```


# Wprowadzenie 

Celem naszego projektu jest analiza zbioru danych dotyczących pacjentów z rakiem płuc. Zbiór danych zawiera informacje demograficzne, kliniczne oraz wyniki leczenia pacjentów. W ramach analizy przeprowadzimy eksploracyjną analizę danych (EDA), a także zastosujemy różne metody statystyczne i uczenia maszynowego w celu zidentyfikowania czynników wpływających na przebieg choroby oraz prognozowania wyników leczenia. Zbiór danych zawiera `r nrow(dane)` wierszy oraz `r ncol(dane)` kolumn.

## Opis danych 

W danych uwzględniono m.in. wiek i płeć pacjentów, czynniki stylu życia takie jak palenie tytoniu, bierne palenie, spożycie alkoholu, dieta oraz występowanie otyłości. Zbiór obejmuje również informacje o narażeniu środowiskowym i zawodowym, w tym poziom zanieczyszczenia powietrza, alergię na kurz oraz ekspozycję zawodową. Dodatkowo uwzględniono objawy kliniczne i choroby współistniejące, takie jak przewlekła choroba płuc, kaszel z krwią, duszność, zmęczenie czy utrata masy ciała. Zmienną wynikową jest poziom zaawansowania choroby nowotworowej, sklasyfikowany jako niski (Low), średni (Medium) lub wysoki (High). Zebrane dane umożliwiają analizę zależności pomiędzy czynnikami ryzyka a stopniem zaawansowania choroby oraz ich graficzną prezentację.

## Problemy badawcze

### Główny problem badawczy

Jakie czynniki demograficzne, środowiskowe oraz związane ze stylem życia mają wpływ na poziom zaawansowania choroby nowotworowej u badanych pacjentów?

### Szczegółowe problemy badawcze

1. Jaki jest rozkład poziomu zaawansowania choroby nowotworowej (Low, Medium, High) w badanej grupie pacjentów?

2. Czy poziom zaawansowania choroby nowotworowej różni się w zależności od płci pacjentów?

3. Czy wiek pacjentów ma związek z poziomem zaawansowania choroby nowotworowej?

4. Czy palenie tytoniu wpływa na poziom zaawansowania choroby nowotworowej?

5. Czy występowanie wybranych objawów klinicznych (np. kaszel z krwią, duszność, zmęczenie) wiąże się z wyższym poziomem choroby?

# Data Wrangling

## Braki danych

```{r echo=FALSE}
procent <- prop_complete_var(dane)*100

```


W danych znajduje się `r procent` % kompletnych wartości 
```{r echo=FALSE}
naniar::vis_miss(dane)
gg_miss_fct(x=dane, fct=Gender)
```

## Wzorzec braków danych

```{r echo=FALSE}
library(finalfit)
missing_pattern(dane)
```
## Walidacja danych

Czy wiek <= 120?

```{r echo=FALSE}
reguly <- validator(
  Age >0 , Age <120)
```

```{r echo=FALSE}
cf<- confront(dane, reguly, key="index")
summary(cf)
barplot(cf)
```

# Wizualizacja danych

## Histogram wieku

Pozwala zobaczyć, jak rozkłada się wiek pacjentów w całej próbie – czy są młodzi, starsi, czy rozkład jest równomierny.
```{r echo=FALSE}
ggplot(dane, aes(x = Age)) +
  geom_histogram(bins = 20) +
  theme_minimal()
```

## Wykres słupkowy poziomu choroby 

Pokazuje proporcje pacjentów w każdej kategorii poziomu choroby („Low”, „Medium”, „High”)  
```{r echo=FALSE}
ggplot(dane, aes(x = Level)) +
  geom_bar() +
  theme_minimal()
```

## Wykres słupkowy skumulowany: Smoking vs. Level

 Palenie tytoniu to jeden z głównych czynników ryzyka raka płuc. Skumulowany wykres słupkowy pokazuje jednocześnie częstość poziomów choroby w każdej kategorii palenia.
```{r echo=FALSE}
ggplot(dane, aes(x = Smoking, fill = Level)) +
  geom_bar(position = "fill") +
  ylab("Udział w grupie") +
  theme_minimal()
